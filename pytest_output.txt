============================= test session starts ==============================
platform darwin -- Python 3.12.7, pytest-8.3.3, pluggy-1.5.0 -- /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/bin/python3.12
cachedir: .pytest_cache
rootdir: /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis
configfile: setup.cfg
plugins: cov-6.0.0, anyio-4.6.2.post1
collecting ... collected 41 items

tests/test_analysis.py::test_transfer_function_initialization PASSED     [  2%]
tests/test_analysis.py::test_matter_transfer_function ERROR              [  4%]
tests/test_analysis.py::test_radiation_transfer_function ERROR           [  7%]
tests/test_analysis.py::test_power_spectrum_computation ERROR            [  9%]
tests/test_analysis.py::test_mcmc_analysis ERROR                         [ 12%]
tests/test_analysis.py::test_mcmc_convergence ERROR                      [ 14%]
tests/test_analysis.py::test_numerical_stability ERROR                   [ 17%]
tests/test_analysis.py::test_acoustic_peaks[100] ERROR                   [ 19%]
tests/test_analysis.py::test_acoustic_peaks[500] ERROR                   [ 21%]
tests/test_analysis.py::test_acoustic_peaks[1000] ERROR                  [ 24%]
tests/test_analysis.py::test_error_propagation ERROR                     [ 26%]
tests/test_cosmology.py::test_lcdm_initialization PASSED                 [ 29%]
tests/test_cosmology.py::test_wcdm_initialization PASSED                 [ 31%]
tests/test_cosmology.py::test_hubble_parameter[0.0] PASSED               [ 34%]
tests/test_cosmology.py::test_hubble_parameter[0.5] PASSED               [ 36%]
tests/test_cosmology.py::test_hubble_parameter[1.0] PASSED               [ 39%]
tests/test_cosmology.py::test_hubble_parameter[2.0] PASSED               [ 41%]
tests/test_cosmology.py::test_hubble_parameter_array FAILED              [ 43%]
tests/test_cosmology.py::test_angular_diameter_distance FAILED           [ 46%]
tests/test_cosmology.py::test_lcdm_wcdm_consistency FAILED               [ 48%]
tests/test_cosmology.py::test_invalid_parameters FAILED                  [ 51%]
tests/test_cosmology.py::test_omega_m_computation FAILED                 [ 53%]
tests/test_cosmology.py::test_age_of_universe FAILED                     [ 56%]
tests/test_cosmology.py::test_physical_constraints[LCDM-params0] FAILED  [ 58%]
tests/test_cosmology.py::test_physical_constraints[wCDM-params1] PASSED  [ 60%]
tests/test_cosmology.py::test_error_handling FAILED                      [ 63%]
tests/test_visualization.py::test_plotter_initialization PASSED          [ 65%]
tests/test_visualization.py::test_power_spectra_plot ERROR               [ 68%]
tests/test_visualization.py::test_residuals_plot ERROR                   [ 70%]
tests/test_visualization.py::test_corner_plot FAILED                     [ 73%]
tests/test_visualization.py::test_chain_evolution FAILED                 [ 75%]
tests/test_visualization.py::test_autocorrelation_plot FAILED            [ 78%]
tests/test_visualization.py::test_convergence_metrics FAILED             [ 80%]
tests/test_visualization.py::test_diagnostic_summary FAILED              [ 82%]
tests/test_visualization.py::test_save_publication_plots ERROR           [ 85%]
tests/test_visualization.py::test_style_consistency PASSED               [ 87%]
tests/test_visualization.py::test_plot_types[power_spectra] ERROR        [ 90%]
tests/test_visualization.py::test_plot_types[residuals] ERROR            [ 92%]
tests/test_visualization.py::test_plot_types[corner] ERROR               [ 95%]
tests/test_visualization.py::test_plot_types[chain_evolution] ERROR      [ 97%]
tests/test_visualization.py::test_plot_types[convergence] ERROR          [100%]

==================================== ERRORS ====================================
_______________ ERROR at setup of test_matter_transfer_function ________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 32
  def test_matter_transfer_function(transfer_calculator, fiducial_params):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:32
______________ ERROR at setup of test_radiation_transfer_function ______________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 44
  def test_radiation_transfer_function(transfer_calculator, fiducial_params):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:44
______________ ERROR at setup of test_power_spectrum_computation _______________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 54
  def test_power_spectrum_computation(power_calculator, fiducial_params, mock_cmb_data):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:54
_____________________ ERROR at setup of test_mcmc_analysis _____________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 69
  def test_mcmc_analysis(mock_cmb_data, fiducial_params):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:69
___________________ ERROR at setup of test_mcmc_convergence ____________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 92
  @pytest.mark.slow
  def test_mcmc_convergence(mock_cmb_data, fiducial_params):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:92
__________________ ERROR at setup of test_numerical_stability __________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 123
  def test_numerical_stability(transfer_calculator, power_calculator, fiducial_params):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:123
__________________ ERROR at setup of test_acoustic_peaks[100] __________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 142
  @pytest.mark.parametrize("ell", [100, 500, 1000])
  def test_acoustic_peaks(power_calculator, fiducial_params, ell):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:142
__________________ ERROR at setup of test_acoustic_peaks[500] __________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 142
  @pytest.mark.parametrize("ell", [100, 500, 1000])
  def test_acoustic_peaks(power_calculator, fiducial_params, ell):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:142
_________________ ERROR at setup of test_acoustic_peaks[1000] __________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 142
  @pytest.mark.parametrize("ell", [100, 500, 1000])
  def test_acoustic_peaks(power_calculator, fiducial_params, ell):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:142
___________________ ERROR at setup of test_error_propagation ___________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py, line 155
  def test_error_propagation(power_calculator, fiducial_params):
E       fixture 'fiducial_params' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, doctest_namespace, monkeypatch, no_cover, power_calculator, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transfer_calculator
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:155
__________________ ERROR at setup of test_power_spectra_plot ___________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 32
  def test_power_spectra_plot(plotter, mock_cmb_data):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:32
____________________ ERROR at setup of test_residuals_plot _____________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 59
  def test_residuals_plot(plotter, mock_cmb_data):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:59
________________ ERROR at setup of test_save_publication_plots _________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 170
  def test_save_publication_plots(plotter, mock_cmb_data, tmp_path):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:170
_______________ ERROR at setup of test_plot_types[power_spectra] _______________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 206
  @pytest.mark.parametrize("fig_type", [
      "power_spectra",
      "residuals",
      "corner",
      "chain_evolution",
      "convergence"
  ])
  def test_plot_types(plotter, diagnostics, mock_cmb_data, fig_type):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:206
_________________ ERROR at setup of test_plot_types[residuals] _________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 206
  @pytest.mark.parametrize("fig_type", [
      "power_spectra",
      "residuals",
      "corner",
      "chain_evolution",
      "convergence"
  ])
  def test_plot_types(plotter, diagnostics, mock_cmb_data, fig_type):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:206
__________________ ERROR at setup of test_plot_types[corner] ___________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 206
  @pytest.mark.parametrize("fig_type", [
      "power_spectra",
      "residuals",
      "corner",
      "chain_evolution",
      "convergence"
  ])
  def test_plot_types(plotter, diagnostics, mock_cmb_data, fig_type):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:206
______________ ERROR at setup of test_plot_types[chain_evolution] ______________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 206
  @pytest.mark.parametrize("fig_type", [
      "power_spectra",
      "residuals",
      "corner",
      "chain_evolution",
      "convergence"
  ])
  def test_plot_types(plotter, diagnostics, mock_cmb_data, fig_type):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:206
________________ ERROR at setup of test_plot_types[convergence] ________________
file /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py, line 206
  @pytest.mark.parametrize("fig_type", [
      "power_spectra",
      "residuals",
      "corner",
      "chain_evolution",
      "convergence"
  ])
  def test_plot_types(plotter, diagnostics, mock_cmb_data, fig_type):
E       fixture 'mock_cmb_data' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cov, diagnostics, doctest_namespace, monkeypatch, no_cover, plotter, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_visualization.py:206
=================================== FAILURES ===================================
_________________________ test_hubble_parameter_array __________________________

    def test_hubble_parameter_array():
        """Test Hubble parameter computation with array input."""
        model = LCDM()
        z = np.linspace(0, 2, 100)
>       H = model.H(z, fiducial_params)

tests/test_cosmology.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = LCDM(params={H0: (67.320, 0.540), omega_b: (0.022, 0.000), omega_cdm: (0.120, 0.001), tau: (0.054, 0.007), ns: (0.965, 0.004), ln10As: (3.044, 0.014)})
z = array([0.        , 0.02020202, 0.04040404, 0.06060606, 0.08080808,
       0.1010101 , 0.12121212, 0.14141414, 0.161616...82, 1.83838384, 1.85858586, 1.87878788, 1.8989899 ,
       1.91919192, 1.93939394, 1.95959596, 1.97979798, 2.        ])
params = <function fiducial_params at 0x111e40680>

    def H(self, z: Union[float, ArrayLike], params: Dict[str, float]) -> Union[float, ArrayLike]:
        """
        Compute the Hubble parameter H(z) for ΛCDM.
    
        Parameters
        ----------
        z : float or array-like
            Redshift
        params : dict
            Cosmological parameters
    
        Returns
        -------
        float or array-like
            Hubble parameter in km/s/Mpc
    
        Notes
        -----
        Uses the Friedmann equation for a flat ΛCDM universe:
        H(z) = H0 * sqrt(Ωm(1+z)³ + ΩΛ)
        """
>       H0 = params['H0']
E       TypeError: 'function' object is not subscriptable

cmb_analysis/cosmology/lcdm.py:69: TypeError
________________________ test_angular_diameter_distance ________________________

    def test_angular_diameter_distance():
        """Test angular diameter distance computation."""
        model = LCDM()
        z = 1089.8  # Last scattering surface
>       D_A = model.angular_diameter_distance(z, fiducial_params)

tests/test_cosmology.py:72: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cmb_analysis/cosmology/lcdm.py:94: in angular_diameter_distance
    if not self.validate_parameters(params):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = LCDM(params={H0: (67.320, 0.540), omega_b: (0.022, 0.000), omega_cdm: (0.120, 0.001), tau: (0.054, 0.007), ns: (0.965, 0.004), ln10As: (3.044, 0.014)})
params = <function fiducial_params at 0x111e40680>

    def validate_parameters(self, params: Dict[str, float]) -> bool:
        """
        Validate cosmological parameters against physical bounds.
    
        Parameters
        ----------
        params : dict
            Cosmological parameters to validate
    
        Returns
        -------
        bool
            True if parameters are valid, False otherwise
    
        Raises
        ------
        ValueError
            If required parameters are missing
        """
        required_params = set(self.param_info.keys())
>       provided_params = set(params.keys())
E       AttributeError: 'function' object has no attribute 'keys'

cmb_analysis/cosmology/base.py:141: AttributeError
__________________________ test_lcdm_wcdm_consistency __________________________

    def test_lcdm_wcdm_consistency():
        """Test that wCDM reduces to ΛCDM when w = -1."""
        z = np.linspace(0, 2, 100)
    
        lcdm = LCDM()
        wcdm = wCDM()
    
        # Add w = -1 to parameters
>       wcdm_params = fiducial_params.copy()
E       AttributeError: 'function' object has no attribute 'copy'

tests/test_cosmology.py:87: AttributeError
___________________________ test_invalid_parameters ____________________________

    def test_invalid_parameters():
        """Test handling of invalid parameters."""
        model = LCDM()
    
>       invalid_params = fiducial_params.copy()
E       AttributeError: 'function' object has no attribute 'copy'

tests/test_cosmology.py:100: AttributeError
___________________________ test_omega_m_computation ___________________________

    def test_omega_m_computation():
        """Test total matter density computation."""
        model = LCDM()
>       omega_m = fiducial_params['omega_b'] + fiducial_params['omega_cdm']
E       TypeError: 'function' object is not subscriptable

tests/test_cosmology.py:110: TypeError
_____________________________ test_age_of_universe _____________________________

    def test_age_of_universe():
        """Test age of universe computation."""
        model = LCDM()
>       age = model.age_of_universe(fiducial_params)

tests/test_cosmology.py:121: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = LCDM(params={H0: (67.320, 0.540), omega_b: (0.022, 0.000), omega_cdm: (0.120, 0.001), tau: (0.054, 0.007), ns: (0.965, 0.004), ln10As: (3.044, 0.014)})
params = <function fiducial_params at 0x111e40680>

    def age_of_universe(self, params: Dict[str, float]) -> float:
        """
        Compute the age of the universe in Gyr.
    
        Parameters
        ----------
        params : dict
            Cosmological parameters
    
        Returns
        -------
        float
            Age of the universe in Gyr
        """
        # Convert H0 to s^-1
>       H0 = params['H0'] * 1000 / self.Mpc
E       TypeError: 'function' object is not subscriptable

cmb_analysis/cosmology/lcdm.py:150: TypeError
___________________ test_physical_constraints[LCDM-params0] ____________________

cosmology = <class 'cmb_analysis.cosmology.lcdm.LCDM'>
params = {'H0': 70, 'omega_b': 0.0486, 'omega_cdm': 0.2589}

    @pytest.mark.parametrize("cosmology,params", [
        (LCDM, {'H0': 70, 'omega_b': 0.0486, 'omega_cdm': 0.2589}),
        (wCDM, {'H0': 70, 'omega_b': 0.0486, 'omega_cdm': 0.2589, 'w': -1.0}),
    ])
    def test_physical_constraints(cosmology, params):
        """Test physical constraints and consistency relations."""
        model = cosmology()
        z = np.linspace(0, 1000, 1000)
    
        # Test Hubble parameter evolution
        H = model.H(z, params)
        assert np.all(np.diff(H) > 0)  # H(z) should increase with z
    
        # Test angular diameter distance
>       D_A = np.array([model.angular_diameter_distance(zi, params)
                       for zi in z[1:]])

tests/test_cosmology.py:142: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cmb_analysis/cosmology/lcdm.py:94: in angular_diameter_distance
    if not self.validate_parameters(params):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = LCDM(params={H0: (67.320, 0.540), omega_b: (0.022, 0.000), omega_cdm: (0.120, 0.001), tau: (0.054, 0.007), ns: (0.965, 0.004), ln10As: (3.044, 0.014)})
params = {'H0': 70, 'omega_b': 0.0486, 'omega_cdm': 0.2589}

    def validate_parameters(self, params: Dict[str, float]) -> bool:
        """
        Validate cosmological parameters against physical bounds.
    
        Parameters
        ----------
        params : dict
            Cosmological parameters to validate
    
        Returns
        -------
        bool
            True if parameters are valid, False otherwise
    
        Raises
        ------
        ValueError
            If required parameters are missing
        """
        required_params = set(self.param_info.keys())
        provided_params = set(params.keys())
    
        if not required_params.issubset(provided_params):
            missing = required_params - provided_params
>           raise ValueError(f"Missing required parameters: {missing}")
E           ValueError: Missing required parameters: {'ns', 'ln10As', 'tau'}

cmb_analysis/cosmology/base.py:145: ValueError
_____________________________ test_error_handling ______________________________

    def test_error_handling():
        """Test error handling in cosmological computations."""
        model = LCDM()
    
        # Test with missing parameters
        with pytest.raises(ValueError):
>           model.H(1.0, {'H0': 70})

tests/test_cosmology.py:158: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = LCDM(params={H0: (67.320, 0.540), omega_b: (0.022, 0.000), omega_cdm: (0.120, 0.001), tau: (0.054, 0.007), ns: (0.965, 0.004), ln10As: (3.044, 0.014)})
z = 1.0, params = {'H0': 70}

    def H(self, z: Union[float, ArrayLike], params: Dict[str, float]) -> Union[float, ArrayLike]:
        """
        Compute the Hubble parameter H(z) for ΛCDM.
    
        Parameters
        ----------
        z : float or array-like
            Redshift
        params : dict
            Cosmological parameters
    
        Returns
        -------
        float or array-like
            Hubble parameter in km/s/Mpc
    
        Notes
        -----
        Uses the Friedmann equation for a flat ΛCDM universe:
        H(z) = H0 * sqrt(Ωm(1+z)³ + ΩΛ)
        """
        H0 = params['H0']
>       omega_m = (params['omega_b'] + params['omega_cdm']) / (H0/100)**2
E       KeyError: 'omega_b'

cmb_analysis/cosmology/lcdm.py:70: KeyError
_______________________________ test_corner_plot _______________________________

plotter = <cmb_analysis.visualization.plotting.CMBPlotter object at 0x1154b6480>

    def test_corner_plot(plotter):
        """Test corner plot functionality."""
        # Create mock MCMC samples
        n_samples = 1000
        n_params = 3
        samples = np.random.normal(size=(n_samples, n_params))
        labels = ['param1', 'param2', 'param3']
    
>       fig = plotter.plot_corner(samples, labels)

tests/test_visualization.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cmb_analysis/visualization/plotting.py:202: in plot_corner
    fig = corner.corner(
venv/lib/python3.12/site-packages/corner/corner.py:248: in corner
    return corner_impl(
venv/lib/python3.12/site-packages/corner/core.py:370: in corner_impl
    hist2d(
venv/lib/python3.12/site-packages/corner/core.py:795: in hist2d
    ax.contour(X2, Y2, H2.T, V, **contour_kwargs)
venv/lib/python3.12/site-packages/matplotlib/__init__.py:1473: in inner
    return func(
venv/lib/python3.12/site-packages/matplotlib/axes/_axes.py:6659: in contour
    contours = mcontour.QuadContourSet(self, *args, **kwargs)
venv/lib/python3.12/site-packages/matplotlib/contour.py:853: in __init__
    self.set_cmap(cmap)
venv/lib/python3.12/site-packages/matplotlib/cm.py:526: in set_cmap
    self.changed()  # Things are not set up properly yet.
venv/lib/python3.12/site-packages/matplotlib/contour.py:1105: in changed
    self._process_colors()  # Sets cvalues.
venv/lib/python3.12/site-packages/matplotlib/contour.py:1259: in _process_colors
    self.set_norm(mcolors.NoNorm())
venv/lib/python3.12/site-packages/matplotlib/cm.py:575: in set_norm
    self.norm = norm
venv/lib/python3.12/site-packages/matplotlib/cm.py:559: in norm
    self.changed()
venv/lib/python3.12/site-packages/matplotlib/contour.py:1112: in changed
    self.update_scalarmappable()
venv/lib/python3.12/site-packages/matplotlib/collections.py:920: in update_scalarmappable
    self._mapped_colors = self.to_rgba(self._A, self._alpha)
venv/lib/python3.12/site-packages/matplotlib/cm.py:431: in to_rgba
    rgba = self.cmap(x, alpha=alpha, bytes=bytes)
venv/lib/python3.12/site-packages/matplotlib/colors.py:737: in __call__
    self._init()
venv/lib/python3.12/site-packages/matplotlib/colors.py:1188: in _init
    self._lut[:-3] = to_rgba_array(self.colors)
venv/lib/python3.12/site-packages/matplotlib/colors.py:510: in to_rgba_array
    rgba = np.array([to_rgba(cc) for cc in c])
venv/lib/python3.12/site-packages/matplotlib/colors.py:314: in to_rgba
    rgba = _to_rgba_no_colorcycle(c, alpha)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

c = 0.00392156862745098, alpha = None

    def _to_rgba_no_colorcycle(c, alpha=None):
        """
        Convert *c* to an RGBA color, with no support for color-cycle syntax.
    
        If *alpha* is given, force the alpha value of the returned RGBA tuple
        to *alpha*. Otherwise, the alpha value from *c* is used, if it has alpha
        information, or defaults to 1.
    
        *alpha* is ignored for the color value ``"none"`` (case-insensitive),
        which always maps to ``(0, 0, 0, 0)``.
        """
        if alpha is not None and not 0 <= alpha <= 1:
            raise ValueError("'alpha' must be between 0 and 1, inclusive")
        orig_c = c
        if c is np.ma.masked:
            return (0., 0., 0., 0.)
        if isinstance(c, str):
            if c.lower() == "none":
                return (0., 0., 0., 0.)
            # Named color.
            try:
                # This may turn c into a non-string, so we check again below.
                c = _colors_full_map[c]
            except KeyError:
                if len(orig_c) != 1:
                    try:
                        c = _colors_full_map[c.lower()]
                    except KeyError:
                        pass
        if isinstance(c, str):
            # hex color in #rrggbb format.
            match = re.match(r"\A#[a-fA-F0-9]{6}\Z", c)
            if match:
                return (tuple(int(n, 16) / 255
                              for n in [c[1:3], c[3:5], c[5:7]])
                        + (alpha if alpha is not None else 1.,))
            # hex color in #rgb format, shorthand for #rrggbb.
            match = re.match(r"\A#[a-fA-F0-9]{3}\Z", c)
            if match:
                return (tuple(int(n, 16) / 255
                              for n in [c[1]*2, c[2]*2, c[3]*2])
                        + (alpha if alpha is not None else 1.,))
            # hex color with alpha in #rrggbbaa format.
            match = re.match(r"\A#[a-fA-F0-9]{8}\Z", c)
            if match:
                color = [int(n, 16) / 255
                         for n in [c[1:3], c[3:5], c[5:7], c[7:9]]]
                if alpha is not None:
                    color[-1] = alpha
                return tuple(color)
            # hex color with alpha in #rgba format, shorthand for #rrggbbaa.
            match = re.match(r"\A#[a-fA-F0-9]{4}\Z", c)
            if match:
                color = [int(n, 16) / 255
                         for n in [c[1]*2, c[2]*2, c[3]*2, c[4]*2]]
                if alpha is not None:
                    color[-1] = alpha
                return tuple(color)
            # string gray.
            try:
                c = float(c)
            except ValueError:
                pass
            else:
                if not (0 <= c <= 1):
                    raise ValueError(
                        f"Invalid string grayscale value {orig_c!r}. "
                        f"Value must be within 0-1 range")
                return c, c, c, alpha if alpha is not None else 1.
            raise ValueError(f"Invalid RGBA argument: {orig_c!r}")
        # turn 2-D array into 1-D array
        if isinstance(c, np.ndarray):
            if c.ndim == 2 and c.shape[0] == 1:
                c = c.reshape(-1)
        # tuple color.
        if not np.iterable(c):
>           raise ValueError(f"Invalid RGBA argument: {orig_c!r}")
E           ValueError: Invalid RGBA argument: 0.00392156862745098

venv/lib/python3.12/site-packages/matplotlib/colors.py:398: ValueError
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/cbook.py", line 298, in process
    func(*args, **kwargs)
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/contour.py", line 1112, in changed
    self.update_scalarmappable()
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/collections.py", line 920, in update_scalarmappable
    self._mapped_colors = self.to_rgba(self._A, self._alpha)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/cm.py", line 431, in to_rgba
    rgba = self.cmap(x, alpha=alpha, bytes=bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 737, in __call__
    self._init()
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 1188, in _init
    self._lut[:-3] = to_rgba_array(self.colors)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 510, in to_rgba_array
    rgba = np.array([to_rgba(cc) for cc in c])
                     ^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 314, in to_rgba
    rgba = _to_rgba_no_colorcycle(c, alpha)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 398, in _to_rgba_no_colorcycle
    raise ValueError(f"Invalid RGBA argument: {orig_c!r}")
ValueError: Invalid RGBA argument: 0.00392156862745098
Traceback (most recent call last):
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/cbook.py", line 298, in process
    func(*args, **kwargs)
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/contour.py", line 1112, in changed
    self.update_scalarmappable()
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/collections.py", line 920, in update_scalarmappable
    self._mapped_colors = self.to_rgba(self._A, self._alpha)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/cm.py", line 431, in to_rgba
    rgba = self.cmap(x, alpha=alpha, bytes=bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 737, in __call__
    self._init()
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 1188, in _init
    self._lut[:-3] = to_rgba_array(self.colors)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 510, in to_rgba_array
    rgba = np.array([to_rgba(cc) for cc in c])
                     ^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 314, in to_rgba
    rgba = _to_rgba_no_colorcycle(c, alpha)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/venv/lib/python3.12/site-packages/matplotlib/colors.py", line 398, in _to_rgba_no_colorcycle
    raise ValueError(f"Invalid RGBA argument: {orig_c!r}")
ValueError: Invalid RGBA argument: 0.00392156862745098
_____________________________ test_chain_evolution _____________________________

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmpd7yz5cbk', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
>           report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:250: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:466: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:548: in run
    with Popen(*popenargs, **kwargs) as process:
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1026: in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <Popen: returncode: 255 args: ['latex', '-interaction=nonstopmode', '--halt-...>
args = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmpd7yz5cbk', 'ebddbc55302063cddd8b76d385f18547.tex']
executable = b'latex', preexec_fn = None, close_fds = True, pass_fds = ()
cwd = PosixPath('/Users/kashyap/.matplotlib/tex.cache/eb/dd'), env = None
startupinfo = None, creationflags = 0, shell = False, p2cread = -1
p2cwrite = -1, c2pread = 12, c2pwrite = 13, errread = -1, errwrite = 13
restore_signals = True, gid = None, gids = None, uid = None, umask = -1
start_new_session = False, process_group = -1

    def _execute_child(self, args, executable, preexec_fn, close_fds,
                       pass_fds, cwd, env,
                       startupinfo, creationflags, shell,
                       p2cread, p2cwrite,
                       c2pread, c2pwrite,
                       errread, errwrite,
                       restore_signals,
                       gid, gids, uid, umask,
                       start_new_session, process_group):
        """Execute program (POSIX version)"""
    
        if isinstance(args, (str, bytes)):
            args = [args]
        elif isinstance(args, os.PathLike):
            if shell:
                raise TypeError('path-like args is not allowed when '
                                'shell is true')
            args = [args]
        else:
            args = list(args)
    
        if shell:
            # On Android the default shell is at '/system/bin/sh'.
            unix_shell = ('/system/bin/sh' if
                      hasattr(sys, 'getandroidapilevel') else '/bin/sh')
            args = [unix_shell, "-c"] + args
            if executable:
                args[0] = executable
    
        if executable is None:
            executable = args[0]
    
        sys.audit("subprocess.Popen", executable, args, cwd, env)
    
        if (_USE_POSIX_SPAWN
                and os.path.dirname(executable)
                and preexec_fn is None
                and not close_fds
                and not pass_fds
                and cwd is None
                and (p2cread == -1 or p2cread > 2)
                and (c2pwrite == -1 or c2pwrite > 2)
                and (errwrite == -1 or errwrite > 2)
                and not start_new_session
                and process_group == -1
                and gid is None
                and gids is None
                and uid is None
                and umask < 0):
            self._posix_spawn(args, executable, env, restore_signals,
                              p2cread, p2cwrite,
                              c2pread, c2pwrite,
                              errread, errwrite)
            return
    
        orig_executable = executable
    
        # For transferring possible exec failure from child to parent.
        # Data format: "exception name:hex errno:description"
        # Pickle is not used; it is complex and involves memory allocation.
        errpipe_read, errpipe_write = os.pipe()
        # errpipe_write must not be in the standard io 0, 1, or 2 fd range.
        low_fds_to_close = []
        while errpipe_write < 3:
            low_fds_to_close.append(errpipe_write)
            errpipe_write = os.dup(errpipe_write)
        for low_fd in low_fds_to_close:
            os.close(low_fd)
        try:
            try:
                # We must avoid complex work that could involve
                # malloc or free in the child process to avoid
                # potential deadlocks, thus we do all this here.
                # and pass it to fork_exec()
    
                if env is not None:
                    env_list = []
                    for k, v in env.items():
                        k = os.fsencode(k)
                        if b'=' in k:
                            raise ValueError("illegal environment variable name")
                        env_list.append(k + b'=' + os.fsencode(v))
                else:
                    env_list = None  # Use execv instead of execve.
                executable = os.fsencode(executable)
                if os.path.dirname(executable):
                    executable_list = (executable,)
                else:
                    # This matches the behavior of os._execvpe().
                    executable_list = tuple(
                        os.path.join(os.fsencode(dir), executable)
                        for dir in os.get_exec_path(env))
                fds_to_keep = set(pass_fds)
                fds_to_keep.add(errpipe_write)
                self.pid = _fork_exec(
                        args, executable_list,
                        close_fds, tuple(sorted(map(int, fds_to_keep))),
                        cwd, env_list,
                        p2cread, p2cwrite, c2pread, c2pwrite,
                        errread, errwrite,
                        errpipe_read, errpipe_write,
                        restore_signals, start_new_session,
                        process_group, gid, gids, uid, umask,
                        preexec_fn, _USE_VFORK)
                self._child_created = True
            finally:
                # be sure the FD is closed no matter what
                os.close(errpipe_write)
    
            self._close_pipe_fds(p2cread, p2cwrite,
                                 c2pread, c2pwrite,
                                 errread, errwrite)
    
            # Wait for exec to fail or succeed; possibly raising an
            # exception (limited in size)
            errpipe_data = bytearray()
            while True:
                part = os.read(errpipe_read, 50000)
                errpipe_data += part
                if not part or len(errpipe_data) > 50000:
                    break
        finally:
            # be sure the FD is closed no matter what
            os.close(errpipe_read)
    
        if errpipe_data:
            try:
                pid, sts = os.waitpid(self.pid, 0)
                if pid == self.pid:
                    self._handle_exitstatus(sts)
                else:
                    self.returncode = sys.maxsize
            except ChildProcessError:
                pass
    
            try:
                exception_name, hex_errno, err_msg = (
                        errpipe_data.split(b':', 2))
                # The encoding here should match the encoding
                # written in by the subprocess implementations
                # like _posixsubprocess
                err_msg = err_msg.decode()
            except ValueError:
                exception_name = b'SubprocessError'
                hex_errno = b'0'
                err_msg = 'Bad exception data from child: {!r}'.format(
                              bytes(errpipe_data))
            child_exception_type = getattr(
                    builtins, exception_name.decode('ascii'),
                    SubprocessError)
            if issubclass(child_exception_type, OSError) and hex_errno:
                errno_num = int(hex_errno, 16)
                if err_msg == "noexec:chdir":
                    err_msg = ""
                    # The error must be from chdir(cwd).
                    err_filename = cwd
                elif err_msg == "noexec":
                    err_msg = ""
                    err_filename = None
                else:
                    err_filename = orig_executable
                if errno_num != 0:
                    err_msg = os.strerror(errno_num)
                if err_filename is not None:
>                   raise child_exception_type(errno_num, err_msg, err_filename)
E                   FileNotFoundError: [Errno 2] No such file or directory: 'latex'

/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1955: FileNotFoundError

The above exception was the direct cause of the following exception:

diagnostics = <cmb_analysis.visualization.diagnostics.MCMCDiagnostics object at 0x1154b72f0>

    def test_chain_evolution(diagnostics):
        """Test MCMC chain evolution plotting."""
        # Create mock chain
        n_steps = 1000
        n_walkers = 32
        n_params = 3
        chain = np.random.normal(size=(n_steps, n_walkers, n_params))
        param_names = ['param1', 'param2', 'param3']
    
>       fig = diagnostics.plot_chain_evolution(chain, param_names)

tests/test_visualization.py:111: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cmb_analysis/visualization/diagnostics.py:65: in plot_chain_evolution
    plt.tight_layout()
venv/lib/python3.12/site-packages/matplotlib/pyplot.py:2801: in tight_layout
    gcf().tight_layout(pad=pad, h_pad=h_pad, w_pad=w_pad, rect=rect)
venv/lib/python3.12/site-packages/matplotlib/figure.py:3545: in tight_layout
    engine.execute(self)
venv/lib/python3.12/site-packages/matplotlib/layout_engine.py:183: in execute
    kwargs = get_tight_layout_figure(
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:266: in get_tight_layout_figure
    kwargs = _auto_adjust_subplotpars(fig, renderer,
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:82: in _auto_adjust_subplotpars
    bb += [martist._get_tightbbox_for_layout_only(ax, renderer)]
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/_api/deprecation.py:457: in wrapper
    return func(*args, **kwargs)
venv/lib/python3.12/site-packages/matplotlib/axes/_base.py:4476: in get_tightbbox
    ba = martist._get_tightbbox_for_layout_only(axis, renderer)
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/axis.py:1372: in get_tightbbox
    self._update_label_position(renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2654: in _update_label_position
    bboxes, bboxes2 = self._get_tick_boxes_siblings(renderer=renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2206: in _get_tick_boxes_siblings
    tlb, tlb2 = axis._get_ticklabel_bboxes(ticks_to_draw, renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:1351: in _get_ticklabel_bboxes
    return ([tick.label1.get_window_extent(renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:959: in get_window_extent
    bbox, info, descent = self._get_layout(self._renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:373: in _get_layout
    _, lp_h, lp_d = _get_text_metrics_with_cache(
venv/lib/python3.12/site-packages/matplotlib/text.py:69: in _get_text_metrics_with_cache
    return _get_text_metrics_with_cache_impl(
venv/lib/python3.12/site-packages/matplotlib/text.py:77: in _get_text_metrics_with_cache_impl
    return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py:212: in get_text_width_height_descent
    return super().get_text_width_height_descent(s, prop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backend_bases.py:597: in get_text_width_height_descent
    return self.get_texmanager().get_text_width_height_descent(
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:363: in get_text_width_height_descent
    dvifile = cls.make_dvi(tex, fontsize)
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:295: in make_dvi
    cls._run_checked_subprocess(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmpd7yz5cbk', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
            report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)
        except FileNotFoundError as exc:
>           raise RuntimeError(
                f'Failed to process string with tex because {command[0]} '
                'could not be found') from exc
E           RuntimeError: Failed to process string with tex because latex could not be found

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:254: RuntimeError
__________________________ test_autocorrelation_plot ___________________________

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmp8ckrz88y', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
>           report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:250: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:466: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:548: in run
    with Popen(*popenargs, **kwargs) as process:
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1026: in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <Popen: returncode: 255 args: ['latex', '-interaction=nonstopmode', '--halt-...>
args = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmp8ckrz88y', 'ebddbc55302063cddd8b76d385f18547.tex']
executable = b'latex', preexec_fn = None, close_fds = True, pass_fds = ()
cwd = PosixPath('/Users/kashyap/.matplotlib/tex.cache/eb/dd'), env = None
startupinfo = None, creationflags = 0, shell = False, p2cread = -1
p2cwrite = -1, c2pread = 12, c2pwrite = 13, errread = -1, errwrite = 13
restore_signals = True, gid = None, gids = None, uid = None, umask = -1
start_new_session = False, process_group = -1

    def _execute_child(self, args, executable, preexec_fn, close_fds,
                       pass_fds, cwd, env,
                       startupinfo, creationflags, shell,
                       p2cread, p2cwrite,
                       c2pread, c2pwrite,
                       errread, errwrite,
                       restore_signals,
                       gid, gids, uid, umask,
                       start_new_session, process_group):
        """Execute program (POSIX version)"""
    
        if isinstance(args, (str, bytes)):
            args = [args]
        elif isinstance(args, os.PathLike):
            if shell:
                raise TypeError('path-like args is not allowed when '
                                'shell is true')
            args = [args]
        else:
            args = list(args)
    
        if shell:
            # On Android the default shell is at '/system/bin/sh'.
            unix_shell = ('/system/bin/sh' if
                      hasattr(sys, 'getandroidapilevel') else '/bin/sh')
            args = [unix_shell, "-c"] + args
            if executable:
                args[0] = executable
    
        if executable is None:
            executable = args[0]
    
        sys.audit("subprocess.Popen", executable, args, cwd, env)
    
        if (_USE_POSIX_SPAWN
                and os.path.dirname(executable)
                and preexec_fn is None
                and not close_fds
                and not pass_fds
                and cwd is None
                and (p2cread == -1 or p2cread > 2)
                and (c2pwrite == -1 or c2pwrite > 2)
                and (errwrite == -1 or errwrite > 2)
                and not start_new_session
                and process_group == -1
                and gid is None
                and gids is None
                and uid is None
                and umask < 0):
            self._posix_spawn(args, executable, env, restore_signals,
                              p2cread, p2cwrite,
                              c2pread, c2pwrite,
                              errread, errwrite)
            return
    
        orig_executable = executable
    
        # For transferring possible exec failure from child to parent.
        # Data format: "exception name:hex errno:description"
        # Pickle is not used; it is complex and involves memory allocation.
        errpipe_read, errpipe_write = os.pipe()
        # errpipe_write must not be in the standard io 0, 1, or 2 fd range.
        low_fds_to_close = []
        while errpipe_write < 3:
            low_fds_to_close.append(errpipe_write)
            errpipe_write = os.dup(errpipe_write)
        for low_fd in low_fds_to_close:
            os.close(low_fd)
        try:
            try:
                # We must avoid complex work that could involve
                # malloc or free in the child process to avoid
                # potential deadlocks, thus we do all this here.
                # and pass it to fork_exec()
    
                if env is not None:
                    env_list = []
                    for k, v in env.items():
                        k = os.fsencode(k)
                        if b'=' in k:
                            raise ValueError("illegal environment variable name")
                        env_list.append(k + b'=' + os.fsencode(v))
                else:
                    env_list = None  # Use execv instead of execve.
                executable = os.fsencode(executable)
                if os.path.dirname(executable):
                    executable_list = (executable,)
                else:
                    # This matches the behavior of os._execvpe().
                    executable_list = tuple(
                        os.path.join(os.fsencode(dir), executable)
                        for dir in os.get_exec_path(env))
                fds_to_keep = set(pass_fds)
                fds_to_keep.add(errpipe_write)
                self.pid = _fork_exec(
                        args, executable_list,
                        close_fds, tuple(sorted(map(int, fds_to_keep))),
                        cwd, env_list,
                        p2cread, p2cwrite, c2pread, c2pwrite,
                        errread, errwrite,
                        errpipe_read, errpipe_write,
                        restore_signals, start_new_session,
                        process_group, gid, gids, uid, umask,
                        preexec_fn, _USE_VFORK)
                self._child_created = True
            finally:
                # be sure the FD is closed no matter what
                os.close(errpipe_write)
    
            self._close_pipe_fds(p2cread, p2cwrite,
                                 c2pread, c2pwrite,
                                 errread, errwrite)
    
            # Wait for exec to fail or succeed; possibly raising an
            # exception (limited in size)
            errpipe_data = bytearray()
            while True:
                part = os.read(errpipe_read, 50000)
                errpipe_data += part
                if not part or len(errpipe_data) > 50000:
                    break
        finally:
            # be sure the FD is closed no matter what
            os.close(errpipe_read)
    
        if errpipe_data:
            try:
                pid, sts = os.waitpid(self.pid, 0)
                if pid == self.pid:
                    self._handle_exitstatus(sts)
                else:
                    self.returncode = sys.maxsize
            except ChildProcessError:
                pass
    
            try:
                exception_name, hex_errno, err_msg = (
                        errpipe_data.split(b':', 2))
                # The encoding here should match the encoding
                # written in by the subprocess implementations
                # like _posixsubprocess
                err_msg = err_msg.decode()
            except ValueError:
                exception_name = b'SubprocessError'
                hex_errno = b'0'
                err_msg = 'Bad exception data from child: {!r}'.format(
                              bytes(errpipe_data))
            child_exception_type = getattr(
                    builtins, exception_name.decode('ascii'),
                    SubprocessError)
            if issubclass(child_exception_type, OSError) and hex_errno:
                errno_num = int(hex_errno, 16)
                if err_msg == "noexec:chdir":
                    err_msg = ""
                    # The error must be from chdir(cwd).
                    err_filename = cwd
                elif err_msg == "noexec":
                    err_msg = ""
                    err_filename = None
                else:
                    err_filename = orig_executable
                if errno_num != 0:
                    err_msg = os.strerror(errno_num)
                if err_filename is not None:
>                   raise child_exception_type(errno_num, err_msg, err_filename)
E                   FileNotFoundError: [Errno 2] No such file or directory: 'latex'

/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1955: FileNotFoundError

The above exception was the direct cause of the following exception:

diagnostics = <cmb_analysis.visualization.diagnostics.MCMCDiagnostics object at 0x1206bfa70>

    def test_autocorrelation_plot(diagnostics):
        """Test autocorrelation plotting functionality."""
        # Create mock chain
        n_steps = 1000
        n_walkers = 32
        n_params = 3
        chain = np.random.normal(size=(n_steps, n_walkers, n_params))
        param_names = ['param1', 'param2', 'param3']
    
>       fig = diagnostics.plot_autocorrelation(chain, param_names)

tests/test_visualization.py:128: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cmb_analysis/visualization/diagnostics.py:100: in plot_autocorrelation
    plt.tight_layout()
venv/lib/python3.12/site-packages/matplotlib/pyplot.py:2801: in tight_layout
    gcf().tight_layout(pad=pad, h_pad=h_pad, w_pad=w_pad, rect=rect)
venv/lib/python3.12/site-packages/matplotlib/figure.py:3545: in tight_layout
    engine.execute(self)
venv/lib/python3.12/site-packages/matplotlib/layout_engine.py:183: in execute
    kwargs = get_tight_layout_figure(
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:266: in get_tight_layout_figure
    kwargs = _auto_adjust_subplotpars(fig, renderer,
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:82: in _auto_adjust_subplotpars
    bb += [martist._get_tightbbox_for_layout_only(ax, renderer)]
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/_api/deprecation.py:457: in wrapper
    return func(*args, **kwargs)
venv/lib/python3.12/site-packages/matplotlib/axes/_base.py:4476: in get_tightbbox
    ba = martist._get_tightbbox_for_layout_only(axis, renderer)
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/axis.py:1372: in get_tightbbox
    self._update_label_position(renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2654: in _update_label_position
    bboxes, bboxes2 = self._get_tick_boxes_siblings(renderer=renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2206: in _get_tick_boxes_siblings
    tlb, tlb2 = axis._get_ticklabel_bboxes(ticks_to_draw, renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:1351: in _get_ticklabel_bboxes
    return ([tick.label1.get_window_extent(renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:959: in get_window_extent
    bbox, info, descent = self._get_layout(self._renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:373: in _get_layout
    _, lp_h, lp_d = _get_text_metrics_with_cache(
venv/lib/python3.12/site-packages/matplotlib/text.py:69: in _get_text_metrics_with_cache
    return _get_text_metrics_with_cache_impl(
venv/lib/python3.12/site-packages/matplotlib/text.py:77: in _get_text_metrics_with_cache_impl
    return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py:212: in get_text_width_height_descent
    return super().get_text_width_height_descent(s, prop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backend_bases.py:597: in get_text_width_height_descent
    return self.get_texmanager().get_text_width_height_descent(
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:363: in get_text_width_height_descent
    dvifile = cls.make_dvi(tex, fontsize)
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:295: in make_dvi
    cls._run_checked_subprocess(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmp8ckrz88y', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
            report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)
        except FileNotFoundError as exc:
>           raise RuntimeError(
                f'Failed to process string with tex because {command[0]} '
                'could not be found') from exc
E           RuntimeError: Failed to process string with tex because latex could not be found

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:254: RuntimeError
___________________________ test_convergence_metrics ___________________________

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmplyfrue7q', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
>           report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:250: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:466: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:548: in run
    with Popen(*popenargs, **kwargs) as process:
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1026: in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <Popen: returncode: 255 args: ['latex', '-interaction=nonstopmode', '--halt-...>
args = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmplyfrue7q', 'ebddbc55302063cddd8b76d385f18547.tex']
executable = b'latex', preexec_fn = None, close_fds = True, pass_fds = ()
cwd = PosixPath('/Users/kashyap/.matplotlib/tex.cache/eb/dd'), env = None
startupinfo = None, creationflags = 0, shell = False, p2cread = -1
p2cwrite = -1, c2pread = 12, c2pwrite = 13, errread = -1, errwrite = 13
restore_signals = True, gid = None, gids = None, uid = None, umask = -1
start_new_session = False, process_group = -1

    def _execute_child(self, args, executable, preexec_fn, close_fds,
                       pass_fds, cwd, env,
                       startupinfo, creationflags, shell,
                       p2cread, p2cwrite,
                       c2pread, c2pwrite,
                       errread, errwrite,
                       restore_signals,
                       gid, gids, uid, umask,
                       start_new_session, process_group):
        """Execute program (POSIX version)"""
    
        if isinstance(args, (str, bytes)):
            args = [args]
        elif isinstance(args, os.PathLike):
            if shell:
                raise TypeError('path-like args is not allowed when '
                                'shell is true')
            args = [args]
        else:
            args = list(args)
    
        if shell:
            # On Android the default shell is at '/system/bin/sh'.
            unix_shell = ('/system/bin/sh' if
                      hasattr(sys, 'getandroidapilevel') else '/bin/sh')
            args = [unix_shell, "-c"] + args
            if executable:
                args[0] = executable
    
        if executable is None:
            executable = args[0]
    
        sys.audit("subprocess.Popen", executable, args, cwd, env)
    
        if (_USE_POSIX_SPAWN
                and os.path.dirname(executable)
                and preexec_fn is None
                and not close_fds
                and not pass_fds
                and cwd is None
                and (p2cread == -1 or p2cread > 2)
                and (c2pwrite == -1 or c2pwrite > 2)
                and (errwrite == -1 or errwrite > 2)
                and not start_new_session
                and process_group == -1
                and gid is None
                and gids is None
                and uid is None
                and umask < 0):
            self._posix_spawn(args, executable, env, restore_signals,
                              p2cread, p2cwrite,
                              c2pread, c2pwrite,
                              errread, errwrite)
            return
    
        orig_executable = executable
    
        # For transferring possible exec failure from child to parent.
        # Data format: "exception name:hex errno:description"
        # Pickle is not used; it is complex and involves memory allocation.
        errpipe_read, errpipe_write = os.pipe()
        # errpipe_write must not be in the standard io 0, 1, or 2 fd range.
        low_fds_to_close = []
        while errpipe_write < 3:
            low_fds_to_close.append(errpipe_write)
            errpipe_write = os.dup(errpipe_write)
        for low_fd in low_fds_to_close:
            os.close(low_fd)
        try:
            try:
                # We must avoid complex work that could involve
                # malloc or free in the child process to avoid
                # potential deadlocks, thus we do all this here.
                # and pass it to fork_exec()
    
                if env is not None:
                    env_list = []
                    for k, v in env.items():
                        k = os.fsencode(k)
                        if b'=' in k:
                            raise ValueError("illegal environment variable name")
                        env_list.append(k + b'=' + os.fsencode(v))
                else:
                    env_list = None  # Use execv instead of execve.
                executable = os.fsencode(executable)
                if os.path.dirname(executable):
                    executable_list = (executable,)
                else:
                    # This matches the behavior of os._execvpe().
                    executable_list = tuple(
                        os.path.join(os.fsencode(dir), executable)
                        for dir in os.get_exec_path(env))
                fds_to_keep = set(pass_fds)
                fds_to_keep.add(errpipe_write)
                self.pid = _fork_exec(
                        args, executable_list,
                        close_fds, tuple(sorted(map(int, fds_to_keep))),
                        cwd, env_list,
                        p2cread, p2cwrite, c2pread, c2pwrite,
                        errread, errwrite,
                        errpipe_read, errpipe_write,
                        restore_signals, start_new_session,
                        process_group, gid, gids, uid, umask,
                        preexec_fn, _USE_VFORK)
                self._child_created = True
            finally:
                # be sure the FD is closed no matter what
                os.close(errpipe_write)
    
            self._close_pipe_fds(p2cread, p2cwrite,
                                 c2pread, c2pwrite,
                                 errread, errwrite)
    
            # Wait for exec to fail or succeed; possibly raising an
            # exception (limited in size)
            errpipe_data = bytearray()
            while True:
                part = os.read(errpipe_read, 50000)
                errpipe_data += part
                if not part or len(errpipe_data) > 50000:
                    break
        finally:
            # be sure the FD is closed no matter what
            os.close(errpipe_read)
    
        if errpipe_data:
            try:
                pid, sts = os.waitpid(self.pid, 0)
                if pid == self.pid:
                    self._handle_exitstatus(sts)
                else:
                    self.returncode = sys.maxsize
            except ChildProcessError:
                pass
    
            try:
                exception_name, hex_errno, err_msg = (
                        errpipe_data.split(b':', 2))
                # The encoding here should match the encoding
                # written in by the subprocess implementations
                # like _posixsubprocess
                err_msg = err_msg.decode()
            except ValueError:
                exception_name = b'SubprocessError'
                hex_errno = b'0'
                err_msg = 'Bad exception data from child: {!r}'.format(
                              bytes(errpipe_data))
            child_exception_type = getattr(
                    builtins, exception_name.decode('ascii'),
                    SubprocessError)
            if issubclass(child_exception_type, OSError) and hex_errno:
                errno_num = int(hex_errno, 16)
                if err_msg == "noexec:chdir":
                    err_msg = ""
                    # The error must be from chdir(cwd).
                    err_filename = cwd
                elif err_msg == "noexec":
                    err_msg = ""
                    err_filename = None
                else:
                    err_filename = orig_executable
                if errno_num != 0:
                    err_msg = os.strerror(errno_num)
                if err_filename is not None:
>                   raise child_exception_type(errno_num, err_msg, err_filename)
E                   FileNotFoundError: [Errno 2] No such file or directory: 'latex'

/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1955: FileNotFoundError

The above exception was the direct cause of the following exception:

diagnostics = <cmb_analysis.visualization.diagnostics.MCMCDiagnostics object at 0x120afb680>

    def test_convergence_metrics(diagnostics):
        """Test convergence metrics plotting."""
        # Create mock chain
        n_steps = 1000
        n_walkers = 32
        n_params = 3
        chain = np.random.normal(size=(n_steps, n_walkers, n_params))
        param_names = ['param1', 'param2', 'param3']
    
>       fig = diagnostics.plot_convergence_metrics(chain, param_names)

tests/test_visualization.py:145: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cmb_analysis/visualization/diagnostics.py:161: in plot_convergence_metrics
    plt.tight_layout()
venv/lib/python3.12/site-packages/matplotlib/pyplot.py:2801: in tight_layout
    gcf().tight_layout(pad=pad, h_pad=h_pad, w_pad=w_pad, rect=rect)
venv/lib/python3.12/site-packages/matplotlib/figure.py:3545: in tight_layout
    engine.execute(self)
venv/lib/python3.12/site-packages/matplotlib/layout_engine.py:183: in execute
    kwargs = get_tight_layout_figure(
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:266: in get_tight_layout_figure
    kwargs = _auto_adjust_subplotpars(fig, renderer,
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:82: in _auto_adjust_subplotpars
    bb += [martist._get_tightbbox_for_layout_only(ax, renderer)]
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/_api/deprecation.py:457: in wrapper
    return func(*args, **kwargs)
venv/lib/python3.12/site-packages/matplotlib/axes/_base.py:4476: in get_tightbbox
    ba = martist._get_tightbbox_for_layout_only(axis, renderer)
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/axis.py:1372: in get_tightbbox
    self._update_label_position(renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2413: in _update_label_position
    bboxes, bboxes2 = self._get_tick_boxes_siblings(renderer=renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2206: in _get_tick_boxes_siblings
    tlb, tlb2 = axis._get_ticklabel_bboxes(ticks_to_draw, renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:1351: in _get_ticklabel_bboxes
    return ([tick.label1.get_window_extent(renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:959: in get_window_extent
    bbox, info, descent = self._get_layout(self._renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:373: in _get_layout
    _, lp_h, lp_d = _get_text_metrics_with_cache(
venv/lib/python3.12/site-packages/matplotlib/text.py:69: in _get_text_metrics_with_cache
    return _get_text_metrics_with_cache_impl(
venv/lib/python3.12/site-packages/matplotlib/text.py:77: in _get_text_metrics_with_cache_impl
    return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py:212: in get_text_width_height_descent
    return super().get_text_width_height_descent(s, prop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backend_bases.py:597: in get_text_width_height_descent
    return self.get_texmanager().get_text_width_height_descent(
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:363: in get_text_width_height_descent
    dvifile = cls.make_dvi(tex, fontsize)
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:295: in make_dvi
    cls._run_checked_subprocess(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmplyfrue7q', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
            report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)
        except FileNotFoundError as exc:
>           raise RuntimeError(
                f'Failed to process string with tex because {command[0]} '
                'could not be found') from exc
E           RuntimeError: Failed to process string with tex because latex could not be found

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:254: RuntimeError
___________________________ test_diagnostic_summary ____________________________

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmptpk_waxp', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
>           report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:250: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:466: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:548: in run
    with Popen(*popenargs, **kwargs) as process:
/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1026: in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <Popen: returncode: 255 args: ['latex', '-interaction=nonstopmode', '--halt-...>
args = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmptpk_waxp', 'ebddbc55302063cddd8b76d385f18547.tex']
executable = b'latex', preexec_fn = None, close_fds = True, pass_fds = ()
cwd = PosixPath('/Users/kashyap/.matplotlib/tex.cache/eb/dd'), env = None
startupinfo = None, creationflags = 0, shell = False, p2cread = -1
p2cwrite = -1, c2pread = 12, c2pwrite = 13, errread = -1, errwrite = 13
restore_signals = True, gid = None, gids = None, uid = None, umask = -1
start_new_session = False, process_group = -1

    def _execute_child(self, args, executable, preexec_fn, close_fds,
                       pass_fds, cwd, env,
                       startupinfo, creationflags, shell,
                       p2cread, p2cwrite,
                       c2pread, c2pwrite,
                       errread, errwrite,
                       restore_signals,
                       gid, gids, uid, umask,
                       start_new_session, process_group):
        """Execute program (POSIX version)"""
    
        if isinstance(args, (str, bytes)):
            args = [args]
        elif isinstance(args, os.PathLike):
            if shell:
                raise TypeError('path-like args is not allowed when '
                                'shell is true')
            args = [args]
        else:
            args = list(args)
    
        if shell:
            # On Android the default shell is at '/system/bin/sh'.
            unix_shell = ('/system/bin/sh' if
                      hasattr(sys, 'getandroidapilevel') else '/bin/sh')
            args = [unix_shell, "-c"] + args
            if executable:
                args[0] = executable
    
        if executable is None:
            executable = args[0]
    
        sys.audit("subprocess.Popen", executable, args, cwd, env)
    
        if (_USE_POSIX_SPAWN
                and os.path.dirname(executable)
                and preexec_fn is None
                and not close_fds
                and not pass_fds
                and cwd is None
                and (p2cread == -1 or p2cread > 2)
                and (c2pwrite == -1 or c2pwrite > 2)
                and (errwrite == -1 or errwrite > 2)
                and not start_new_session
                and process_group == -1
                and gid is None
                and gids is None
                and uid is None
                and umask < 0):
            self._posix_spawn(args, executable, env, restore_signals,
                              p2cread, p2cwrite,
                              c2pread, c2pwrite,
                              errread, errwrite)
            return
    
        orig_executable = executable
    
        # For transferring possible exec failure from child to parent.
        # Data format: "exception name:hex errno:description"
        # Pickle is not used; it is complex and involves memory allocation.
        errpipe_read, errpipe_write = os.pipe()
        # errpipe_write must not be in the standard io 0, 1, or 2 fd range.
        low_fds_to_close = []
        while errpipe_write < 3:
            low_fds_to_close.append(errpipe_write)
            errpipe_write = os.dup(errpipe_write)
        for low_fd in low_fds_to_close:
            os.close(low_fd)
        try:
            try:
                # We must avoid complex work that could involve
                # malloc or free in the child process to avoid
                # potential deadlocks, thus we do all this here.
                # and pass it to fork_exec()
    
                if env is not None:
                    env_list = []
                    for k, v in env.items():
                        k = os.fsencode(k)
                        if b'=' in k:
                            raise ValueError("illegal environment variable name")
                        env_list.append(k + b'=' + os.fsencode(v))
                else:
                    env_list = None  # Use execv instead of execve.
                executable = os.fsencode(executable)
                if os.path.dirname(executable):
                    executable_list = (executable,)
                else:
                    # This matches the behavior of os._execvpe().
                    executable_list = tuple(
                        os.path.join(os.fsencode(dir), executable)
                        for dir in os.get_exec_path(env))
                fds_to_keep = set(pass_fds)
                fds_to_keep.add(errpipe_write)
                self.pid = _fork_exec(
                        args, executable_list,
                        close_fds, tuple(sorted(map(int, fds_to_keep))),
                        cwd, env_list,
                        p2cread, p2cwrite, c2pread, c2pwrite,
                        errread, errwrite,
                        errpipe_read, errpipe_write,
                        restore_signals, start_new_session,
                        process_group, gid, gids, uid, umask,
                        preexec_fn, _USE_VFORK)
                self._child_created = True
            finally:
                # be sure the FD is closed no matter what
                os.close(errpipe_write)
    
            self._close_pipe_fds(p2cread, p2cwrite,
                                 c2pread, c2pwrite,
                                 errread, errwrite)
    
            # Wait for exec to fail or succeed; possibly raising an
            # exception (limited in size)
            errpipe_data = bytearray()
            while True:
                part = os.read(errpipe_read, 50000)
                errpipe_data += part
                if not part or len(errpipe_data) > 50000:
                    break
        finally:
            # be sure the FD is closed no matter what
            os.close(errpipe_read)
    
        if errpipe_data:
            try:
                pid, sts = os.waitpid(self.pid, 0)
                if pid == self.pid:
                    self._handle_exitstatus(sts)
                else:
                    self.returncode = sys.maxsize
            except ChildProcessError:
                pass
    
            try:
                exception_name, hex_errno, err_msg = (
                        errpipe_data.split(b':', 2))
                # The encoding here should match the encoding
                # written in by the subprocess implementations
                # like _posixsubprocess
                err_msg = err_msg.decode()
            except ValueError:
                exception_name = b'SubprocessError'
                hex_errno = b'0'
                err_msg = 'Bad exception data from child: {!r}'.format(
                              bytes(errpipe_data))
            child_exception_type = getattr(
                    builtins, exception_name.decode('ascii'),
                    SubprocessError)
            if issubclass(child_exception_type, OSError) and hex_errno:
                errno_num = int(hex_errno, 16)
                if err_msg == "noexec:chdir":
                    err_msg = ""
                    # The error must be from chdir(cwd).
                    err_filename = cwd
                elif err_msg == "noexec":
                    err_msg = ""
                    err_filename = None
                else:
                    err_filename = orig_executable
                if errno_num != 0:
                    err_msg = os.strerror(errno_num)
                if err_filename is not None:
>                   raise child_exception_type(errno_num, err_msg, err_filename)
E                   FileNotFoundError: [Errno 2] No such file or directory: 'latex'

/usr/local/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py:1955: FileNotFoundError

The above exception was the direct cause of the following exception:

diagnostics = <cmb_analysis.visualization.diagnostics.MCMCDiagnostics object at 0x1205e84a0>

    def test_diagnostic_summary(diagnostics):
        """Test comprehensive diagnostic summary plot."""
        # Create mock chain and data
        n_steps = 1000
        n_walkers = 32
        n_params = 3
        chain = np.random.normal(size=(n_steps, n_walkers, n_params))
        param_names = ['param1', 'param2', 'param3']
        acceptance_fraction = 0.5
    
>       fig = diagnostics.plot_diagnostic_summary(
            chain, param_names, acceptance_fraction
        )

tests/test_visualization.py:163: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cmb_analysis/visualization/diagnostics.py:358: in plot_diagnostic_summary
    plt.tight_layout()
venv/lib/python3.12/site-packages/matplotlib/pyplot.py:2801: in tight_layout
    gcf().tight_layout(pad=pad, h_pad=h_pad, w_pad=w_pad, rect=rect)
venv/lib/python3.12/site-packages/matplotlib/figure.py:3545: in tight_layout
    engine.execute(self)
venv/lib/python3.12/site-packages/matplotlib/layout_engine.py:183: in execute
    kwargs = get_tight_layout_figure(
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:266: in get_tight_layout_figure
    kwargs = _auto_adjust_subplotpars(fig, renderer,
venv/lib/python3.12/site-packages/matplotlib/_tight_layout.py:82: in _auto_adjust_subplotpars
    bb += [martist._get_tightbbox_for_layout_only(ax, renderer)]
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/_api/deprecation.py:457: in wrapper
    return func(*args, **kwargs)
venv/lib/python3.12/site-packages/matplotlib/axes/_base.py:4476: in get_tightbbox
    ba = martist._get_tightbbox_for_layout_only(axis, renderer)
venv/lib/python3.12/site-packages/matplotlib/artist.py:1410: in _get_tightbbox_for_layout_only
    return obj.get_tightbbox(*args, **{**kwargs, "for_layout_only": True})
venv/lib/python3.12/site-packages/matplotlib/axis.py:1372: in get_tightbbox
    self._update_label_position(renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2413: in _update_label_position
    bboxes, bboxes2 = self._get_tick_boxes_siblings(renderer=renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:2206: in _get_tick_boxes_siblings
    tlb, tlb2 = axis._get_ticklabel_bboxes(ticks_to_draw, renderer)
venv/lib/python3.12/site-packages/matplotlib/axis.py:1351: in _get_ticklabel_bboxes
    return ([tick.label1.get_window_extent(renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:959: in get_window_extent
    bbox, info, descent = self._get_layout(self._renderer)
venv/lib/python3.12/site-packages/matplotlib/text.py:373: in _get_layout
    _, lp_h, lp_d = _get_text_metrics_with_cache(
venv/lib/python3.12/site-packages/matplotlib/text.py:69: in _get_text_metrics_with_cache
    return _get_text_metrics_with_cache_impl(
venv/lib/python3.12/site-packages/matplotlib/text.py:77: in _get_text_metrics_with_cache_impl
    return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py:212: in get_text_width_height_descent
    return super().get_text_width_height_descent(s, prop, ismath)
venv/lib/python3.12/site-packages/matplotlib/backend_bases.py:597: in get_text_width_height_descent
    return self.get_texmanager().get_text_width_height_descent(
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:363: in get_text_width_height_descent
    dvifile = cls.make_dvi(tex, fontsize)
venv/lib/python3.12/site-packages/matplotlib/texmanager.py:295: in make_dvi
    cls._run_checked_subprocess(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = <class 'matplotlib.texmanager.TexManager'>
command = ['latex', '-interaction=nonstopmode', '--halt-on-error', '--output-directory=tmptpk_waxp', 'ebddbc55302063cddd8b76d385f18547.tex']
tex = 'lp'

    @classmethod
    def _run_checked_subprocess(cls, command, tex, *, cwd=None):
        _log.debug(cbook._pformat_subprocess(command))
        try:
            report = subprocess.check_output(
                command, cwd=cwd if cwd is not None else cls._texcache,
                stderr=subprocess.STDOUT)
        except FileNotFoundError as exc:
>           raise RuntimeError(
                f'Failed to process string with tex because {command[0]} '
                'could not be found') from exc
E           RuntimeError: Failed to process string with tex because latex could not be found

venv/lib/python3.12/site-packages/matplotlib/texmanager.py:254: RuntimeError
=============================== warnings summary ===============================
tests/test_analysis.py:92
  /Users/kashyap/Documents/KT/Computational Astrophysics/CMBAnalysis/CMBAnalysis/tests/test_analysis.py:92: PytestUnknownMarkWarning: Unknown pytest.mark.slow - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.slow

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform darwin, python 3.12.7-final-0 ----------
Name                                        Stmts   Miss  Cover   Missing
-------------------------------------------------------------------------
cmb_analysis/__init__.py                       78      1    99%   128
cmb_analysis/analysis/__init__.py               4      0   100%
cmb_analysis/analysis/mcmc.py                 103     82    20%   42-53, 69-80, 96-117, 133-136, 147-166, 177-180, 196-209, 229-231, 242-255, 266-269, 283-306, 326-330
cmb_analysis/analysis/power_spectrum.py        61     39    36%   61-85, 112-120, 149-158, 176, 194-207, 223, 244
cmb_analysis/analysis/transfer.py              80     43    46%   83-94, 114-142, 162-170, 188-198, 217-227, 245-252, 263
cmb_analysis/constants.py                      78      1    99%   128
cmb_analysis/cosmology/__init__.py              4      0   100%
cmb_analysis/cosmology/base.py                 46     14    70%   82, 101, 148-159, 170, 174
cmb_analysis/cosmology/lcdm.py                 37     19    49%   95-116, 132-133, 152-167
cmb_analysis/cosmology/wcdm.py                 22      0   100%
cmb_analysis/utils/__init__.py                  3      3     0%   12-17
cmb_analysis/utils/math.py                     85     85     0%   5-281
cmb_analysis/utils/statistics.py              139    139     0%   5-440
cmb_analysis/visualization/__init__.py          3      0   100%
cmb_analysis/visualization/diagnostics.py     131     25    81%   56, 66, 90, 101, 162, 259-288, 359
cmb_analysis/visualization/plotting.py         91     64    30%   76-95, 117-137, 159-179, 219, 247-272, 297-316, 334-335
-------------------------------------------------------------------------
TOTAL                                         965    515    47%

=========================== short test summary info ============================
FAILED tests/test_cosmology.py::test_hubble_parameter_array - TypeError: 'function' object is not subscriptable
FAILED tests/test_cosmology.py::test_angular_diameter_distance - AttributeError: 'function' object has no attribute 'keys'
FAILED tests/test_cosmology.py::test_lcdm_wcdm_consistency - AttributeError: 'function' object has no attribute 'copy'
FAILED tests/test_cosmology.py::test_invalid_parameters - AttributeError: 'function' object has no attribute 'copy'
FAILED tests/test_cosmology.py::test_omega_m_computation - TypeError: 'function' object is not subscriptable
FAILED tests/test_cosmology.py::test_age_of_universe - TypeError: 'function' object is not subscriptable
FAILED tests/test_cosmology.py::test_physical_constraints[LCDM-params0] - ValueError: Missing required parameters: {'ns', 'ln10As', 'tau'}
FAILED tests/test_cosmology.py::test_error_handling - KeyError: 'omega_b'
FAILED tests/test_visualization.py::test_corner_plot - ValueError: Invalid RGBA argument: 0.00392156862745098
FAILED tests/test_visualization.py::test_chain_evolution - RuntimeError: Failed to process string with tex because latex could not be found
FAILED tests/test_visualization.py::test_autocorrelation_plot - RuntimeError: Failed to process string with tex because latex could not be found
FAILED tests/test_visualization.py::test_convergence_metrics - RuntimeError: Failed to process string with tex because latex could not be found
FAILED tests/test_visualization.py::test_diagnostic_summary - RuntimeError: Failed to process string with tex because latex could not be found
ERROR tests/test_analysis.py::test_matter_transfer_function
ERROR tests/test_analysis.py::test_radiation_transfer_function
ERROR tests/test_analysis.py::test_power_spectrum_computation
ERROR tests/test_analysis.py::test_mcmc_analysis
ERROR tests/test_analysis.py::test_mcmc_convergence
ERROR tests/test_analysis.py::test_numerical_stability
ERROR tests/test_analysis.py::test_acoustic_peaks[100]
ERROR tests/test_analysis.py::test_acoustic_peaks[500]
ERROR tests/test_analysis.py::test_acoustic_peaks[1000]
ERROR tests/test_analysis.py::test_error_propagation
ERROR tests/test_visualization.py::test_power_spectra_plot
ERROR tests/test_visualization.py::test_residuals_plot
ERROR tests/test_visualization.py::test_save_publication_plots
ERROR tests/test_visualization.py::test_plot_types[power_spectra]
ERROR tests/test_visualization.py::test_plot_types[residuals]
ERROR tests/test_visualization.py::test_plot_types[corner]
ERROR tests/test_visualization.py::test_plot_types[chain_evolution]
ERROR tests/test_visualization.py::test_plot_types[convergence]
============= 13 failed, 10 passed, 1 warning, 18 errors in 15.15s =============
